{"version":3,"file":"login.js","sources":["pages/login/login.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<template>\r\n\t<view class=\"login-container\">\r\n\t\t<!-- 顶部装饰 -->\r\n\t\t<view class=\"top-decoration\">\r\n\t\t\t<view class=\"circle circle-1\"></view>\r\n\t\t\t<view class=\"circle circle-2\"></view>\r\n\t\t\t<view class=\"circle circle-3\"></view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 标题区域 -->\r\n\t\t<view class=\"header-section\">\r\n\t\t\t<view class=\"app-logo\">\r\n\t\t\t\t<image src=\"/static/c1.png\" class=\"logo-image\" mode=\"aspectFit\"></image>\r\n\t\t\t</view>\r\n\t\t\t<text class=\"app-title\">备忘录</text>\r\n\t\t\t<text class=\"app-subtitle\">记录生活，管理时间</text>\r\n\t\t</view>\r\n\r\n\t\t<!-- 登录表单 -->\r\n\t\t<view class=\"form-section\">\r\n\t\t\t<uni-card class=\"login-card\" :is-shadow=\"true\" shadow=\"0 8px 24px rgba(0,0,0,0.1)\">\r\n\t\t\t\t<view class=\"form-title\">用户登录</view>\r\n\r\n\t\t\t\t<!-- 用户名输入 -->\r\n\t\t\t\t<view class=\"input-group\">\r\n\t\t\t\t\t<view class=\"input-label\">\r\n\t\t\t\t\t\t<uni-icons type=\"person\" size=\"18\" color=\"#666\"></uni-icons>\r\n\t\t\t\t\t\t<text class=\"label-text\">用户名</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<uni-easyinput v-model=\"loginForm.username\" placeholder=\"请输入用户名\" :clearable=\"true\"\r\n\t\t\t\t\t\tclass=\"custom-input\" :inputBorder=\"false\" :styles=\"inputStyles\"></uni-easyinput>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<!-- 密码输入 -->\r\n\t\t\t\t<view class=\"input-group\">\r\n\t\t\t\t\t<view class=\"input-label\">\r\n\t\t\t\t\t\t<uni-icons type=\"locked\" size=\"18\" color=\"#666\"></uni-icons>\r\n\t\t\t\t\t\t<text class=\"label-text\">密码</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<uni-easyinput v-model=\"loginForm.password\" type=\"password\" placeholder=\"请输入密码\" :clearable=\"true\"\r\n\t\t\t\t\t\tclass=\"custom-input\" :inputBorder=\"false\" :styles=\"inputStyles\"></uni-easyinput>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<!-- 记住密码选项 -->\r\n\t\t\t\t<view class=\"remember-section\">\r\n\t\t\t\t\t<uni-data-checkbox v-model=\"loginForm.remember\" :localdata=\"rememberOptions\" mode=\"tag\"\r\n\t\t\t\t\t\tclass=\"remember-checkbox\"></uni-data-checkbox>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<!-- 登录按钮 -->\r\n\t\t\t\t<button class=\"login-btn\" :class=\"{ 'loading': isLoading }\" :disabled=\"isLoading\" @click=\"handleLogin\">\r\n\t\t\t\t\t<uni-icons v-if=\"!isLoading\" type=\"forward\" size=\"18\" color=\"white\"></uni-icons>\r\n\t\t\t\t\t<uni-load-more v-else status=\"loading\" :content-text=\"loadingText\"></uni-load-more>\r\n\t\t\t\t\t<text class=\"btn-text\">{{ isLoading ? '登录中...' : '立即登录' }}</text>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t<!-- 其他操作 -->\r\n\t\t\t\t<view class=\"other-actions\">\r\n\t\t\t\t\t<text class=\"action-link\" @click=\"goToRegister\">注册账号</text>\r\n\t\t\t\t\t<text class=\"action-divider\">|</text>\r\n\t\t\t\t\t<text class=\"action-link\" @click=\"forgotPassword\">忘记密码</text>\r\n\t\t\t\t</view>\r\n\t\t\t</uni-card>\r\n\t\t</view>\r\n\r\n\t\t<!-- 底部提示 -->\r\n\t\t<view class=\"bottom-tips\">\r\n\t\t\t<text class=\"tip-text\">登录即表示同意</text>\r\n\t\t\t<text class=\"tip-link\" @click=\"showTerms\">用户协议</text>\r\n\t\t\t<text class=\"tip-text\">和</text>\r\n\t\t\t<text class=\"tip-link\" @click=\"showPrivacy\">隐私政策</text>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref,\r\n\t\treactive\r\n\t} from 'vue'\r\n\timport {\r\n\t\tsafeLoginApi\r\n\t} from '@/api/safeUserApi.js'\r\n\timport {\r\n\t\tonLoad\r\n\t} from '@dcloudio/uni-app'\r\n\t// 响应式数据\r\n\tconst isLoading = ref(false)\r\n\tconst loginForm = reactive({\r\n\t\tusername: '',\r\n\t\tpassword: '',\r\n\t\tremember: 'false'\r\n\t})\r\n\r\n\t// 记住密码选项\r\n\tconst rememberOptions = [\r\n\r\n\t\t{\r\n\t\t\tvalue: 'false',\r\n\t\t\ttext: '不记住'\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: 'true',\r\n\t\t\ttext: '记住密码'\r\n\t\t}\r\n\t]\r\n\r\n\t// 输入框样式\r\n\tconst inputStyles = {\r\n\t\tcolor: '#333',\r\n\t\tfontSize: '16px',\r\n\t\tbackgroundColor: '#f8f9fa'\r\n\t}\r\n\r\n\t// 加载提示文字\r\n\tconst loadingText = {\r\n\t\tcontentdown: '登录中...',\r\n\t\tcontentrefresh: '登录中...',\r\n\t\tcontentnomore: '登录中...'\r\n\t}\r\n\r\n\t// 登录处理\r\n\tconst handleLogin = async () => {\r\n\t\t// 表单验证\r\n\t\tif (!loginForm.username.trim()) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请输入用户名',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tif (!loginForm.password.trim()) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请输入密码',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tisLoading.value = true\r\n\r\n\t\t// 使用安全API，不需要try-catch\r\n\t\tconst response = await safeLoginApi.login({\r\n\t\t\tusername: loginForm.username.trim(),\r\n\t\t\tpassword: loginForm.password\r\n\t\t})\r\n\t\tconsole.log(response)\r\n\r\n\t\tif (response) {\r\n\t\t\t// 存储 token\r\n\t\t\tuni.setStorageSync('token', response.token)\r\n\t\t\t// 存储用户信息\r\n\t\t\tuni.setStorageSync('userInfo', response.userInfo)\r\n\t\t\t// 记住密码 - 注意这里需要转换类型\r\n\t\t\tif (loginForm.remember === 'true') { // 改为字符串比较\r\n\t\t\t\tuni.setStorageSync('rememberedUser', {\r\n\t\t\t\t\tusername: loginForm.username,\r\n\t\t\t\t\tpassword: loginForm.password\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tuni.removeStorageSync('rememberedUser')\r\n\t\t\t}\r\n\r\n\t\t\t// 显示成功提示\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '登录成功',\r\n\t\t\t\ticon: 'success'\r\n\t\t\t})\r\n\r\n\t\t\tuni.switchTab({\r\n\t\t\t\turl: '/pages/memo/memo',\r\n\t\t\t\tsuccess: () => {\r\n\t\t\t\t\tconsole.log('跳转到首页成功')\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tconsole.error('跳转失败:', err)\r\n\t\t\t\t\t// 如果 switchTab 失败，尝试使用 reLaunch\r\n\t\t\t\t\tuni.reLaunch({\r\n\t\t\t\t\t\turl: '/pages/memo/memo'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\r\n\t\t}\r\n\r\n\t\t// 无论成功失败，都需要重置loading状态\r\n\t\tisLoading.value = false\r\n\t}\r\n\r\n\t// 注册页面\r\n\tconst goToRegister = () => {\r\n\t\tuni.showToast({\r\n\t\t\ttitle: '注册功能开发中',\r\n\t\t\ticon: 'none'\r\n\t\t})\r\n\t}\r\n\r\n\t// 忘记密码\r\n\tconst forgotPassword = () => {\r\n\t\tuni.showToast({\r\n\t\t\ttitle: '密码重置功能开发中',\r\n\t\t\ticon: 'none'\r\n\t\t})\r\n\t}\r\n\r\n\t// 用户协议\r\n\tconst showTerms = () => {\r\n\t\tuni.showToast({\r\n\t\t\ttitle: '用户协议功能开发中',\r\n\t\t\ticon: 'none'\r\n\t\t})\r\n\t}\r\n\r\n\t// 隐私政策\r\n\tconst showPrivacy = () => {\r\n\t\tuni.showToast({\r\n\t\t\ttitle: '隐私政策功能开发中',\r\n\t\t\ticon: 'none'\r\n\t\t})\r\n\t}\r\n\r\n\t// 页面加载时检查是否有记住的用户信息\r\n\tonLoad(() => {\r\n\t\tconst rememberedUser = uni.getStorageSync('rememberedUser')\r\n\t\tif (rememberedUser) {\r\n\t\t\tloginForm.username = rememberedUser.username\r\n\t\t\tloginForm.password = rememberedUser.password\r\n\t\t\tloginForm.remember = 'true'\r\n\t\t}\r\n\t})\r\n</script>\r\n\r\n<style scoped>\r\n\t.login-container {\r\n\t\tmin-height: 100vh;\r\n\t\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n\t\tposition: relative;\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t/* 顶部装饰 */\r\n\t.top-decoration {\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\theight: 300rpx;\r\n\t}\r\n\r\n\t.circle {\r\n\t\tposition: absolute;\r\n\t\tborder-radius: 50%;\r\n\t\tbackground: rgba(255, 255, 255, 0.1);\r\n\t}\r\n\r\n\t.circle-1 {\r\n\t\twidth: 200rpx;\r\n\t\theight: 200rpx;\r\n\t\ttop: -100rpx;\r\n\t\tright: -50rpx;\r\n\t}\r\n\r\n\t.circle-2 {\r\n\t\twidth: 150rpx;\r\n\t\theight: 150rpx;\r\n\t\ttop: 50rpx;\r\n\t\tleft: -75rpx;\r\n\t}\r\n\r\n\t.circle-3 {\r\n\t\twidth: 100rpx;\r\n\t\theight: 100rpx;\r\n\t\ttop: 150rpx;\r\n\t\tright: 100rpx;\r\n\t}\r\n\r\n\t/* 标题区域 */\r\n\t.header-section {\r\n\t\ttext-align: center;\r\n\t\tpadding: 120rpx 40rpx 80rpx;\r\n\t\tposition: relative;\r\n\t\tz-index: 2;\r\n\t}\r\n\r\n\t.app-logo {\r\n\t\tmargin-bottom: 30rpx;\r\n\t}\r\n\r\n\t.logo-image {\r\n\t\twidth: 120rpx;\r\n\t\theight: 120rpx;\r\n\t\tborder-radius: 50%;\r\n\t\tbox-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);\r\n\t}\r\n\r\n\t.app-title {\r\n\t\tdisplay: block;\r\n\t\tfont-size: 48rpx;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: white;\r\n\t\tmargin-bottom: 20rpx;\r\n\t\ttext-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);\r\n\t}\r\n\r\n\t.app-subtitle {\r\n\t\tdisplay: block;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: rgba(255, 255, 255, 0.8);\r\n\t\tfont-weight: 300;\r\n\t}\r\n\r\n\t/* 表单区域 */\r\n\t.form-section {\r\n\t\tpadding: 0 40rpx;\r\n\t\tposition: relative;\r\n\t\tz-index: 2;\r\n\t}\r\n\r\n\t.login-card {\r\n\t\tbackground: white;\r\n\t\tborder-radius: 24rpx;\r\n\t\tpadding: 60rpx 40rpx;\r\n\t\tbox-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);\r\n\t}\r\n\r\n\t.form-title {\r\n\t\ttext-align: center;\r\n\t\tfont-size: 36rpx;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #333;\r\n\t\tmargin-bottom: 60rpx;\r\n\t}\r\n\r\n\t.input-group {\r\n\t\tmargin-bottom: 40rpx;\r\n\t}\r\n\r\n\t.input-label {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\r\n\t.label-text {\r\n\t\tmargin-left: 16rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #666;\r\n\t\tfont-weight: 500;\r\n\t}\r\n\r\n\t.custom-input {\r\n\t\tbackground: #f8f9fa;\r\n\t\tborder-radius: 16rpx;\r\n\t\tpadding: 8rpx;\r\n\t}\r\n\r\n\t/* 记住密码 */\r\n\t.remember-section {\r\n\t\tmargin-bottom: 50rpx;\r\n\t}\r\n\r\n\t.remember-checkbox {\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t/* 登录按钮 */\r\n\t.login-btn {\r\n\t\twidth: 100%;\r\n\t\theight: 88rpx;\r\n\t\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n\t\tborder: none;\r\n\t\tborder-radius: 44rpx;\r\n\t\tcolor: white;\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: bold;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tbox-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);\r\n\t\ttransition: all 0.3s ease;\r\n\t\tmargin-bottom: 40rpx;\r\n\t}\r\n\r\n\t.login-btn:active {\r\n\t\ttransform: translateY(2rpx);\r\n\t\tbox-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);\r\n\t}\r\n\r\n\t.login-btn.loading {\r\n\t\topacity: 0.8;\r\n\t}\r\n\r\n\t.btn-text {\r\n\t\tmargin-left: 16rpx;\r\n\t}\r\n\r\n\t/* 其他操作 */\r\n\t.other-actions {\r\n\t\ttext-align: center;\r\n\t\tmargin-bottom: 40rpx;\r\n\t}\r\n\r\n\t.action-link {\r\n\t\tcolor: #667eea;\r\n\t\tfont-size: 28rpx;\r\n\t\tpadding: 0 20rpx;\r\n\t}\r\n\r\n\t.action-divider {\r\n\t\tcolor: #ddd;\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n\r\n\t/* 底部提示 */\r\n\t.bottom-tips {\r\n\t\ttext-align: center;\r\n\t\tpadding: 40rpx;\r\n\t\tposition: relative;\r\n\t\tz-index: 2;\r\n\t}\r\n\r\n\t.tip-text {\r\n\t\tcolor: rgba(255, 255, 255, 0.7);\r\n\t\tfont-size: 24rpx;\r\n\t}\r\n\r\n\t.tip-link {\r\n\t\tcolor: rgba(255, 255, 255, 0.9);\r\n\t\tfont-size: 24rpx;\r\n\t\ttext-decoration: underline;\r\n\t\tmargin: 0 8rpx;\r\n\t}\r\n</style>","import MiniProgramPage from 'E:/PrivateProject/front/note/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","reactive","uni","safeLoginApi","onLoad"],"mappings":"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"}