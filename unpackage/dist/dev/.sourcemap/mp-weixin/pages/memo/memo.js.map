{"version":3,"file":"memo.js","sources":["pages/memo/memo.vue","pages/memo/memo.vue?type=page"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<uni-row class=\"content-row\" margin=\"0px\" v-for=\"memo in memoList\" :key=\"memo.id\">\r\n\t\t\t<uni-col :span=\"24\">\r\n\t\t\t\t<uni-card :title=\"memo.title\" :extra=\"memo.updatedAt\">\r\n\t\t\t\t\t<text class=\"uni-body\">{{memo.content}}</text>\r\n\t\t\t\t</uni-card>\r\n\t\t\t</uni-col>\r\n\t\t</uni-row>\r\n\t\t<!-- 无长度的情况 -->\r\n\t\t<view v-if=\"memoList.length === 0\" class=\"empty\">\r\n\t\t\t<text>暂无备忘录</text>\r\n\t\t</view>\r\n\t\t<!-- 分页器放底部 -->\r\n\t\t<view class=\"pagination-wrapper\">\r\n\t\t\t<uni-pagination class=\"pagination\" :show-icon=\"true\" :total=\"total\" :current=\"pageNum\" :page-size=\"pageSize\"\r\n\t\t\t\t@change=\"handlePageChange\" />\r\n\t\t\t<view class=\"pagination-right\">总条数：{{total}}</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref,\r\n\t\tonMounted\r\n\t} from 'vue'\r\n\timport {\r\n\t\tsafeMemoApi\r\n\t} from '@/api/safeApi.js'\r\n\timport {\r\n\t\thandleAsync\r\n\t} from '@/utils/errorHandler.js'\r\n\r\n\t// 响应式数据\r\n\tconst memoList = ref([]) // memo列表\r\n\tconst loading = ref(false) // 加载状态\r\n\tconst total = ref(0) // 总条数\r\n\tconst pageNum = ref(1) // 分页器当前页数\r\n\tconst pageSize = ref(10) // 分页器一页条数\r\n\r\n\t// 加载备忘录列表\r\n\tconst loadMemoList = async () => {\r\n\t\tloading.value = true\r\n\t\tconst params = {\r\n\t\t\tpageNum: pageNum.value,\r\n\t\t\tpageSize: pageSize.value,\r\n\t\t\t// 后端从jwt获取用户ID，不再传uid\r\n\t\t\tcategoryIds: \"1,2\",\r\n\t\t\tkeyword: '' // 可以留空或填关键词\r\n\t\t}\r\n\r\n\t\tconst data = await safeMemoApi.getMemoList(params)\r\n\t\t// 自动处理报错\r\n\t\tif (data) {\r\n\t\t\ttotal.value = data.total\r\n\t\t\tconsole.log(data)\r\n\t\t\tmemoList.value = data?.records || [] // ⚠️ 注意分页结果在 data.records\r\n\t\t}\r\n\t\tloading.value = false\r\n\t}\n\t\r\n\t// 点击备忘录\r\n\tconst handleMemoClick = (memo) => {\r\n\t\t// 使用handleAsync包装异步操作\r\n\t\thandleAsync(\r\n\t\t\tasync () => {\r\n\t\t\t\tconsole.log('点击了备忘录:', memo.title)\r\n\t\t\t\t// 这里可以是任何异步操作，比如获取详情、更新状态等\r\n\t\t\t\t// 模拟异步操作\r\n\t\t\t\tawait new Promise(resolve => setTimeout(resolve, 100))\r\n\t\t\t\treturn memo\r\n\t\t\t}, {\r\n\t\t\t\tshowError: true,\r\n\t\t\t\terrorMsg: '操作失败',\r\n\t\t\t\tloading: false,\r\n\t\t\t\tonSuccess: (result) => {\r\n\t\t\t\t\t// 成功回调\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: `点击了: ${result.title}`,\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t)\r\n\t}\r\n\r\n\t// 处理分页变化\r\n\tconst handlePageChange = (e) => {\r\n\t\tpageNum.value = e.current\r\n\t\t// 使用handleAsync包装异步操作\r\n\t\thandleAsync(\r\n\t\t\tasync () => {\r\n\t\t\t\tawait loadMemoList()\r\n\t\t\t\treturn {\r\n\t\t\t\t\tsuccess: true\r\n\t\t\t\t}\r\n\t\t\t}, {\r\n\t\t\t\tshowError: true,\r\n\t\t\t\terrorMsg: '加载分页数据失败',\r\n\t\t\t\tloading: false\r\n\t\t\t}\r\n\t\t)\r\n\t}\r\n\r\n\t// 页面加载时获取数据\r\n\tonMounted(() => {\r\n\t\tloadMemoList()\r\n\t})\r\n</script>\r\n\r\n<style scoped>\r\n\t.container {\r\n\t\tmin-height: calc(100vh);\r\n\t}\r\n\r\n\t/* 列表 */\r\n\t.container .content-row {\r\n\t\tflex: 1;\r\n\t\toverflow: auto;\r\n\t}\r\n\r\n\t/* 分页器 */\r\n\t.pagination-wrapper {\r\n\t\theight: 100rpx;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\tbackground-color: #fff;\r\n\t\tposition: fixed;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tz-index: 99;\r\n\t\tbox-shadow: 0 -2rpx 10rpx rgba(0, 0, 0, 0.05);\r\n\t\tpadding: 0rpx 20rpx;\r\n\r\n\t\t/* 使用安全区适配底部 */\r\n\t\tbottom: calc(env(safe-area-inset-bottom));\r\n\t}\r\n\r\n\t.container .pagination-wrapper .pagination {\r\n\t\twidth: 60%;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t/* 内部样式改变 */\r\n\t.container .pagination-wrapper .pagination :deep(.uni-pagination) {\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.container .pagination-wrapper .pagination-right {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tfont-size: 14px;\r\n\t}\r\n\r\n\r\n\t.empty {\r\n\t\ttext-align: center;\r\n\t\tpadding: 100rpx 0;\r\n\t\tcolor: #999;\r\n\t}\r\n</style>","import MiniProgramPage from '/Users/jevonsmac/Desktop/project/front/note/pages/memo/memo.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","safeMemoApi","uni","handleAsync","onMounted"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAmCC,UAAM,WAAWA,cAAG,IAAC,EAAE;AACvB,UAAM,UAAUA,cAAG,IAAC,KAAK;AACzB,UAAM,QAAQA,cAAG,IAAC,CAAC;AACnB,UAAM,UAAUA,cAAG,IAAC,CAAC;AACrB,UAAM,WAAWA,cAAG,IAAC,EAAE;AAGvB,UAAM,eAAe,YAAY;AAChC,cAAQ,QAAQ;AAChB,YAAM,SAAS;AAAA,QACd,SAAS,QAAQ;AAAA,QACjB,UAAU,SAAS;AAAA;AAAA,QAEnB,aAAa;AAAA,QACb,SAAS;AAAA;AAAA,MACT;AAED,YAAM,OAAO,MAAMC,wBAAY,YAAY,MAAM;AAEjD,UAAI,MAAM;AACT,cAAM,QAAQ,KAAK;AACnBC,sBAAAA,MAAY,MAAA,OAAA,6BAAA,IAAI;AAChB,iBAAS,SAAQ,6BAAM,YAAW,CAAE;AAAA,MACpC;AACD,cAAQ,QAAQ;AAAA,IAChB;AA4BD,UAAM,mBAAmB,CAAC,MAAM;AAC/B,cAAQ,QAAQ,EAAE;AAElBC,yBAAW;AAAA,QACV,YAAY;AACX,gBAAM,aAAc;AACpB,iBAAO;AAAA,YACN,SAAS;AAAA,UACT;AAAA,QACL;AAAA,QAAM;AAAA,UACF,WAAW;AAAA,UACX,UAAU;AAAA,UACV,SAAS;AAAA,QACT;AAAA,MACD;AAAA,IACD;AAGDC,kBAAAA,UAAU,MAAM;AACf,mBAAc;AAAA,IAChB,CAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3GF,GAAG,WAAW,eAAe;"}