{"version":3,"file":"user.js","sources":["pages/user/user.vue","pages/user/user.vue?type=page"],"sourcesContent":["<template>\r\n\t<view class=\"user-container\">\r\n\t\t<!-- 用户信息卡片 -->\r\n\t\t<uni-card class=\"user-card\" :is-shadow=\"true\" shadow=\"0 8px 24px rgba(0,0,0,0.1)\">\r\n\t\t\t<view class=\"user-header\">\r\n\t\t\t\t<view class=\"avatar-section\">\r\n\t\t\t\t\t<image :src=\"userInfo.avatar || '/static/c1.png'\" class=\"user-avatar\" mode=\"aspectFill\"\r\n\t\t\t\t\t\t@click=\"changeAvatar\"></image>\r\n\t\t\t\t\t<view class=\"avatar-edit\">\r\n\t\t\t\t\t\t<uni-icons type=\"camera\" size=\"16\" color=\"white\"></uni-icons>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"user-details\">\r\n\t\t\t\t\t<text class=\"username\">{{ userInfo.username || '未登录' }}</text>\r\n\t\t\t\t\t<text class=\"user-email\">{{ userInfo.email || '点击登录' }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"user-status\">\r\n\t\t\t\t\t<uni-tag :text=\"userInfo.status || '离线'\"\r\n\t\t\t\t\t\t:type=\"userInfo.status === '在线' ? 'success' : 'warning'\"></uni-tag>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</uni-card>\r\n\r\n\t\t<!-- 功能菜单 -->\r\n\t\t<uni-card class=\"menu-card\" :is-shadow=\"true\" shadow=\"0 4px 16px rgba(0,0,0,0.08)\">\r\n\t\t\t<uni-list>\r\n\t\t\t\t<uni-list-item title=\"个人资料\" link to=\"/pages/user/profile\" showArrow thumb=\"/static/c1.png\">\r\n\t\t\t\t\t<template v-slot:header>\r\n\t\t\t\t\t\t<uni-icons type=\"person\" size=\"20\" color=\"#667eea\"></uni-icons>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</uni-list-item>\r\n\r\n\t\t\t\t<uni-list-item title=\"修改密码\" link to=\"/pages/user/change-password\" showArrow thumb=\"/static/c2.png\">\r\n\t\t\t\t\t<template v-slot:header>\r\n\t\t\t\t\t\t<uni-icons type=\"locked\" size=\"20\" color=\"#667eea\"></uni-icons>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</uni-list-item>\r\n\r\n\t\t\t\t<uni-list-item title=\"消息通知\" link to=\"/pages/user/notifications\" showArrow thumb=\"/static/c3.png\">\r\n\t\t\t\t\t<template v-slot:header>\r\n\t\t\t\t\t\t<uni-icons type=\"notification\" size=\"20\" color=\"#667eea\"></uni-icons>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</uni-list-item>\r\n\r\n\t\t\t\t<uni-list-item title=\"隐私设置\" link to=\"/pages/user/privacy\" showArrow thumb=\"/static/c1.png\">\r\n\t\t\t\t\t<template v-slot:header>\r\n\t\t\t\t\t\t<uni-icons type=\"eye\" size=\"20\" color=\"#667eea\"></uni-icons>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</uni-list-item>\r\n\t\t\t</uni-list>\r\n\t\t</uni-card>\r\n\r\n\t\t<!-- 应用信息 -->\r\n\t\t<uni-card class=\"info-card\" :is-shadow=\"true\" shadow=\"0 4px 16px rgba(0,0,0,0.08)\">\r\n\t\t\t<view class=\"card-title\">\r\n\t\t\t\t<uni-icons type=\"info\" size=\"18\" color=\"#666\"></uni-icons>\r\n\t\t\t\t<text class=\"title-text\">应用信息</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"info-list\">\r\n\t\t\t\t<view class=\"info-item\">\r\n\t\t\t\t\t<text class=\"info-label\">当前应用:</text>\r\n\t\t\t\t\t<text class=\"info-value\">{{ appSettings.name }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"info-item\">\r\n\t\t\t\t\t<text class=\"info-label\">版本:</text>\r\n\t\t\t\t\t<text class=\"info-value\">{{ appSettings.version }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"info-item\">\r\n\t\t\t\t\t<text class=\"info-label\">分类数量:</text>\r\n\t\t\t\t\t<text class=\"info-value\">{{ memoConfig.categories.length }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"info-item\">\r\n\t\t\t\t\t<text class=\"info-label\">登录时间:</text>\r\n\t\t\t\t\t<text class=\"info-value\">{{ formatLoginTime() }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</uni-card>\r\n\r\n\t\t<!-- 退出登录按钮 -->\r\n\t\t<view class=\"logout-section\">\r\n\t\t\t<button class=\"logout-btn\" @click=\"handleLogout\">\r\n\t\t\t\t<uni-icons type=\"logout\" size=\"18\" color=\"white\"></uni-icons>\r\n\t\t\t\t<text class=\"logout-text\">退出登录</text>\r\n\t\t\t</button>\r\n\t\t</view>\r\n\r\n\t\t<!-- 底部安全提示 -->\r\n\t\t<view class=\"bottom-tips\">\r\n\t\t\t<text class=\"tip-text\">为了您的账户安全，请及时退出登录</text>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref,\r\n\t\tonMounted\r\n\t} from 'vue'\r\n\timport {\r\n\t\tappSettings,\r\n\t\tmemoConfig\r\n\t} from '@/config/index.js'\r\n\timport {\r\n\t\tsafeUserApi\r\n\t} from '@/api/safeUserApi.js'\r\n\r\n\t// 响应式数据\r\n\tconst userInfo = ref({})\r\n\r\n\t// 获取用户信息\r\n\tconst loadUserInfo = async () => {\r\n\t\ttry {\r\n\t\t\tconst info = uni.getStorageSync('userInfo')\r\n\t\t\tif (info) {\r\n\t\t\t\tuserInfo.value = info\r\n\t\t\t} else {\r\n\t\t\t\t// 如果没有本地用户信息，尝试从API获取\r\n\t\t\t\tconst response = await safeUserApi.getUserInfo()\r\n\t\t\t\tif (response) {\r\n\t\t\t\t\tuserInfo.value = response\r\n\t\t\t\t\tuni.setStorageSync('userInfo', response)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('获取用户信息失败:', error)\r\n\t\t}\r\n\t}\r\n\r\n\t// 修改头像\r\n\tconst changeAvatar = () => {\r\n\t\tuni.chooseImage({\r\n\t\t\tcount: 1,\r\n\t\t\tsizeType: ['compressed'],\r\n\t\t\tsourceType: ['album', 'camera'],\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tconst tempFilePath = res.tempFilePaths[0]\r\n\t\t\t\t// 这里可以调用上传头像的API\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '头像上传功能开发中',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t// 退出登录\r\n\tconst handleLogout = () => {\r\n\t\tuni.showModal({\r\n\t\t\ttitle: '确认退出',\r\n\t\t\tcontent: '确定要退出登录吗？',\r\n\t\t\tsuccess: async (res) => {\r\n\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\t// 调用后端登出API\r\n\t\t\t\t\t\tawait safeUserApi.logout()\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\tconsole.error('登出API调用失败:', error)\r\n\t\t\t\t\t} finally {\r\n\t\t\t\t\t\t// 无论API是否成功，都清除本地数据\r\n\t\t\t\t\t\tuni.removeStorageSync('token')\r\n\t\t\t\t\t\tuni.removeStorageSync('userInfo')\r\n\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '已退出登录',\r\n\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t// 跳转到登录页\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tuni.redirectTo({\r\n\t\t\t\t\t\t\t\turl: '/pages/login/login'\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}, 1500)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t// 格式化登录时间\r\n\tconst formatLoginTime = () => {\r\n\t\tconst loginTime = uni.getStorageSync('loginTime')\r\n\t\tif (loginTime) {\r\n\t\t\tconst date = new Date(loginTime)\r\n\t\t\treturn date.toLocaleString('zh-CN')\r\n\t\t}\r\n\t\treturn '未知'\r\n\t}\r\n\r\n\t// 页面加载时获取用户信息\r\n\tonMounted(() => {\r\n\t\tloadUserInfo()\r\n\t})\r\n</script>\r\n\r\n<style scoped>\r\n\t.user-container {\r\n\t\tmin-height: 100vh;\r\n\t\tbackground: #f5f7fa;\r\n\t\tpadding: 20rpx;\r\n\t}\r\n\r\n\t/* 用户卡片 */\r\n\t.user-card {\r\n\t\tmargin-bottom: 20rpx;\r\n\t\tborder-radius: 20rpx;\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.user-header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 20rpx 0;\r\n\t}\r\n\r\n\t.avatar-section {\r\n\t\tposition: relative;\r\n\t\tmargin-right: 30rpx;\r\n\t}\r\n\r\n\t.user-avatar {\r\n\t\twidth: 120rpx;\r\n\t\theight: 120rpx;\r\n\t\tborder-radius: 50%;\r\n\t\tborder: 4rpx solid #fff;\r\n\t\tbox-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\r\n\t}\r\n\r\n\t.avatar-edit {\r\n\t\tposition: absolute;\r\n\t\tbottom: 0;\r\n\t\tright: 0;\r\n\t\twidth: 36rpx;\r\n\t\theight: 36rpx;\r\n\t\tbackground: #667eea;\r\n\t\tborder-radius: 50%;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tborder: 2rpx solid #fff;\r\n\t}\r\n\r\n\t.user-details {\r\n\t\tflex: 1;\r\n\t}\r\n\r\n\t.username {\r\n\t\tdisplay: block;\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #333;\r\n\t\tmargin-bottom: 10rpx;\r\n\t}\r\n\r\n\t.user-email {\r\n\t\tdisplay: block;\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #666;\r\n\t}\r\n\r\n\t.user-status {\r\n\t\tmargin-left: 20rpx;\r\n\t}\r\n\r\n\t/* 菜单卡片 */\r\n\t.menu-card {\r\n\t\tmargin-bottom: 20rpx;\r\n\t\tborder-radius: 20rpx;\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t/* 信息卡片 */\r\n\t.info-card {\r\n\t\tmargin-bottom: 20rpx;\r\n\t\tborder-radius: 20rpx;\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.card-title {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tmargin-bottom: 30rpx;\r\n\t}\r\n\r\n\t.title-text {\r\n\t\tmargin-left: 16rpx;\r\n\t\tfont-size: 30rpx;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.info-list {\r\n\t\tpadding: 0 20rpx;\r\n\t}\r\n\r\n\t.info-item {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tpadding: 20rpx 0;\r\n\t\tborder-bottom: 1rpx solid #f0f0f0;\r\n\t}\r\n\r\n\t.info-item:last-child {\r\n\t\tborder-bottom: none;\r\n\t}\r\n\r\n\t.info-label {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #666;\r\n\t}\r\n\r\n\t.info-value {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #333;\r\n\t\tfont-weight: 500;\r\n\t}\r\n\r\n\t/* 退出登录 */\r\n\t.logout-section {\r\n\t\tpadding: 40rpx 20rpx;\r\n\t}\r\n\r\n\t.logout-btn {\r\n\t\twidth: 100%;\r\n\t\theight: 88rpx;\r\n\t\tbackground: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);\r\n\t\tborder: none;\r\n\t\tborder-radius: 44rpx;\r\n\t\tcolor: white;\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: bold;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tbox-shadow: 0 8px 24px rgba(255, 107, 107, 0.3);\r\n\t\ttransition: all 0.3s ease;\r\n\t}\r\n\r\n\t.logout-btn:active {\r\n\t\ttransform: translateY(2rpx);\r\n\t\tbox-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);\r\n\t}\r\n\r\n\t.logout-text {\r\n\t\tmargin-left: 16rpx;\r\n\t}\r\n\r\n\t/* 底部提示 */\r\n\t.bottom-tips {\r\n\t\ttext-align: center;\r\n\t\tpadding: 40rpx 20rpx;\r\n\t}\r\n\r\n\t.tip-text {\r\n\t\tcolor: #999;\r\n\t\tfont-size: 24rpx;\r\n\t}\r\n</style>","import MiniProgramPage from '/Users/jevonsmac/Desktop/project/front/note/pages/user/user.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","safeUserApi","onMounted"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AA4GC,UAAM,WAAWA,cAAG,IAAC,EAAE;AAGvB,UAAM,eAAe,YAAY;AAChC,UAAI;AACH,cAAM,OAAOC,cAAAA,MAAI,eAAe,UAAU;AAC1C,YAAI,MAAM;AACT,mBAAS,QAAQ;AAAA,QACrB,OAAU;AAEN,gBAAM,WAAW,MAAMC,gBAAW,YAAC,YAAa;AAChD,cAAI,UAAU;AACb,qBAAS,QAAQ;AACjBD,gCAAI,eAAe,YAAY,QAAQ;AAAA,UACvC;AAAA,QACD;AAAA,MACD,SAAQ,OAAO;AACfA,sBAAAA,MAAc,MAAA,SAAA,8BAAA,aAAa,KAAK;AAAA,MAChC;AAAA,IACD;AAGD,UAAM,eAAe,MAAM;AAC1BA,oBAAAA,MAAI,YAAY;AAAA,QACf,OAAO;AAAA,QACP,UAAU,CAAC,YAAY;AAAA,QACvB,YAAY,CAAC,SAAS,QAAQ;AAAA,QAC9B,SAAS,CAAC,QAAQ;AACI,cAAI,cAAc,CAAC;AAExCA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO;AAAA,YACP,MAAM;AAAA,UACX,CAAK;AAAA,QACD;AAAA,MACJ,CAAG;AAAA,IACD;AAGD,UAAM,eAAe,MAAM;AAC1BA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,OAAO,QAAQ;AACvB,cAAI,IAAI,SAAS;AAChB,gBAAI;AAEH,oBAAMC,gBAAAA,YAAY,OAAQ;AAAA,YAC1B,SAAQ,OAAO;AACfD,4BAAAA,MAAc,MAAA,SAAA,8BAAA,cAAc,KAAK;AAAA,YACvC,UAAe;AAETA,4BAAG,MAAC,kBAAkB,OAAO;AAC7BA,4BAAG,MAAC,kBAAkB,UAAU;AAEhCA,4BAAAA,MAAI,UAAU;AAAA,gBACb,OAAO;AAAA,gBACP,MAAM;AAAA,cACb,CAAO;AAGD,yBAAW,MAAM;AAChBA,8BAAAA,MAAI,WAAW;AAAA,kBACd,KAAK;AAAA,gBACb,CAAQ;AAAA,cACD,GAAE,IAAI;AAAA,YACP;AAAA,UACD;AAAA,QACD;AAAA,MACJ,CAAG;AAAA,IACD;AAGD,UAAM,kBAAkB,MAAM;AAC7B,YAAM,YAAYA,cAAAA,MAAI,eAAe,WAAW;AAChD,UAAI,WAAW;AACd,cAAM,OAAO,IAAI,KAAK,SAAS;AAC/B,eAAO,KAAK,eAAe,OAAO;AAAA,MAClC;AACD,aAAO;AAAA,IACP;AAGDE,kBAAAA,UAAU,MAAM;AACf,mBAAc;AAAA,IAChB,CAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChMF,GAAG,WAAW,eAAe;"}