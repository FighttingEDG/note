"use strict";const e=require("../../common/vendor.js"),o=require("../../common/assets.js"),n=require("../../api/safeUserApi.js");if(!Array){(e.resolveComponent("uni-icons")+e.resolveComponent("uni-easyinput")+e.resolveComponent("uni-data-checkbox")+e.resolveComponent("uni-load-more")+e.resolveComponent("uni-card"))()}Math||((()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.js")+(()=>"../../uni_modules/uni-data-checkbox/components/uni-data-checkbox/uni-data-checkbox.js")+(()=>"../../uni_modules/uni-load-more/components/uni-load-more/uni-load-more.js")+(()=>"../../uni_modules/uni-card/components/uni-card/uni-card.js"))();const s={__name:"login",setup(s){const r=e.ref(!1),a=e.reactive({username:"",password:"",remember:"false"}),t=[{value:"false",text:"不记住"},{value:"true",text:"记住密码"}],i={color:"#333",fontSize:"16px",backgroundColor:"#f8f9fa"},u={contentdown:"登录中...",contentrefresh:"登录中...",contentnomore:"登录中..."},c=async()=>{if(!a.username.trim())return void e.index.showToast({title:"请输入用户名",icon:"none"});if(!a.password.trim())return void e.index.showToast({title:"请输入密码",icon:"none"});r.value=!0;const o=await n.safeLoginApi.login({username:a.username.trim(),password:a.password});console.log(o),o&&(e.index.setStorageSync("token",o.token),e.index.setStorageSync("userInfo",o.userInfo),"true"===a.remember?e.index.setStorageSync("rememberedUser",{username:a.username,password:a.password}):e.index.removeStorageSync("rememberedUser"),e.index.showToast({title:"登录成功",icon:"success"}),e.index.switchTab({url:"/pages/memo/memo",success:()=>{console.log("跳转到首页成功")},fail:o=>{console.error("跳转失败:",o),e.index.reLaunch({url:"/pages/memo/memo"})}})),r.value=!1},m=()=>{e.index.showToast({title:"注册功能开发中",icon:"none"})},d=()=>{e.index.showToast({title:"密码重置功能开发中",icon:"none"})},l=()=>{e.index.showToast({title:"用户协议功能开发中",icon:"none"})},p=()=>{e.index.showToast({title:"隐私政策功能开发中",icon:"none"})};return e.onLoad((()=>{const o=e.index.getStorageSync("rememberedUser");o&&(a.username=o.username,a.password=o.password,a.remember="true")})),(n,s)=>e.e({a:o._imports_0,b:e.p({type:"person",size:"18",color:"#666"}),c:e.o((e=>a.username=e)),d:e.p({placeholder:"请输入用户名",clearable:!0,inputBorder:!1,styles:i,modelValue:a.username}),e:e.p({type:"locked",size:"18",color:"#666"}),f:e.o((e=>a.password=e)),g:e.p({type:"password",placeholder:"请输入密码",clearable:!0,inputBorder:!1,styles:i,modelValue:a.password}),h:e.o((e=>a.remember=e)),i:e.p({localdata:t,mode:"tag",modelValue:a.remember}),j:!r.value},r.value?{l:e.p({status:"loading","content-text":u})}:{k:e.p({type:"forward",size:"18",color:"white"})},{m:e.t(r.value?"登录中...":"立即登录"),n:r.value?1:"",o:r.value,p:e.o(c),q:e.o(m),r:e.o(d),s:e.p({"is-shadow":!0,shadow:"0 8px 24px rgba(0,0,0,0.1)"}),t:e.o(l),v:e.o(p)})}},r=e._export_sfc(s,[["__scopeId","data-v-f8e9bf9c"]]);wx.createPage(r);
