"use strict";const e=require("../../common/vendor.js"),o=require("../../config/index.js"),t=require("../../api/safeUserApi.js");if(!Array){(e.resolveComponent("uni-icons")+e.resolveComponent("uni-tag")+e.resolveComponent("uni-card")+e.resolveComponent("uni-list-item")+e.resolveComponent("uni-list"))()}Math||((()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../uni_modules/uni-tag/components/uni-tag/uni-tag.js")+(()=>"../../uni_modules/uni-card/components/uni-card/uni-card.js")+(()=>"../../uni_modules/uni-list/components/uni-list-item/uni-list-item.js")+(()=>"../../uni_modules/uni-list/components/uni-list/uni-list.js"))();const s={__name:"user",setup(s){const n=e.ref({}),i=()=>{e.index.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:o=>{o.tempFilePaths[0],e.index.showToast({title:"头像上传功能开发中",icon:"none"})}})},r=()=>{e.index.showModal({title:"确认退出",content:"确定要退出登录吗？",success:async o=>{if(o.confirm)try{await t.safeUserApi.logout()}catch(s){console.error("登出API调用失败:",s)}finally{e.index.removeStorageSync("token"),e.index.removeStorageSync("userInfo"),e.index.showToast({title:"已退出登录",icon:"success"}),setTimeout((()=>{e.index.redirectTo({url:"/pages/login/login"})}),1500)}}})},a=()=>{const o=e.index.getStorageSync("loginTime");if(o){return new Date(o).toLocaleString("zh-CN")}return"未知"};return e.onMounted((()=>{(async()=>{try{const o=e.index.getStorageSync("userInfo");if(o)n.value=o;else{const o=await t.safeUserApi.getUserInfo();o&&(n.value=o,e.index.setStorageSync("userInfo",o))}}catch(o){console.error("获取用户信息失败:",o)}})()})),(t,s)=>({a:n.value.avatar||"/static/c1.png",b:e.o(i),c:e.p({type:"camera",size:"16",color:"white"}),d:e.t(n.value.username||"未登录"),e:e.t(n.value.email||"点击登录"),f:e.p({text:n.value.status||"离线",type:"在线"===n.value.status?"success":"warning"}),g:e.p({"is-shadow":!0,shadow:"0 8px 24px rgba(0,0,0,0.1)"}),h:e.p({type:"person",size:"20",color:"#667eea"}),i:e.p({title:"个人资料",link:!0,to:"/pages/user/profile",showArrow:!0,thumb:"/static/c1.png"}),j:e.p({type:"locked",size:"20",color:"#667eea"}),k:e.p({title:"修改密码",link:!0,to:"/pages/user/change-password",showArrow:!0,thumb:"/static/c2.png"}),l:e.p({type:"notification",size:"20",color:"#667eea"}),m:e.p({title:"消息通知",link:!0,to:"/pages/user/notifications",showArrow:!0,thumb:"/static/c3.png"}),n:e.p({type:"eye",size:"20",color:"#667eea"}),o:e.p({title:"隐私设置",link:!0,to:"/pages/user/privacy",showArrow:!0,thumb:"/static/c1.png"}),p:e.p({"is-shadow":!0,shadow:"0 4px 16px rgba(0,0,0,0.08)"}),q:e.p({type:"info",size:"18",color:"#666"}),r:e.t(e.unref(o.appSettings).name),s:e.t(e.unref(o.appSettings).version),t:e.t(e.unref(o.memoConfig).categories.length),v:e.t(a()),w:e.p({"is-shadow":!0,shadow:"0 4px 16px rgba(0,0,0,0.08)"}),x:e.p({type:"logout",size:"18",color:"white"}),y:e.o(r)})}},n=e._export_sfc(s,[["__scopeId","data-v-f5930db2"]]);wx.createPage(n);
